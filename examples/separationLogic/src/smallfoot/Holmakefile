INCLUDES=..


MLYACCLIB = $(protect $(HOLDIR)/tools/mlyacc/mlyacclib/)
MLYACCLIB_UIS = $(patsubst %,MLY_%.ui,base-sig join lrtable parser2 stream)

EXTRA_CLEANS = smallfoot.grm-sig.sml smallfoot.grm.sml smallfoot.lex.sig \
               smallfoot.lex.sml smallfoot.grm.sig


Parsetree.uo : Parsetree.sml
	HOLMOSMLC -c Parsetree.sml

smallfoot.grm.sml smallfoot.grm-sig.sml: smallfoot.grm Parsetree.uo
	$(protect $(HOLDIR)/tools/mlyacc/src/mlyacc.exe) $<
	$(MV) smallfoot.grm.sig smallfoot.grm-sig.sml

smallfoot.grm-sig.uo: smallfoot.grm-sig.sml Parsetree.uo
	$(HOLMOSMLC) -toplevel -c -I $(MLYACCLIB) $(MLYACCLIB_UIS) $<

smallfoot.grm.uo: smallfoot.grm.sml smallfoot.grm-sig.uo Parsetree.uo 
	$(HOLMOSMLC) -toplevel -c -I $(MLYACCLIB) $(MLYACCLIB_UIS) smallfoot.grm-sig.ui $<

smallfoot.lex.sml: smallfoot.lex Parsetree.uo
	$(protect $(HOLDIR)/tools/mllex/mllex.exe) $<

smallfoot.lex.uo: smallfoot.lex.sml Parsetree.uo
	$(HOLMOSMLC) -toplevel -c Parsetree.uo smallfoot.grm-sig.ui $<

AssembleSmallfootParser.uo: AssembleSmallfootParser.sml AssembleSmallfootParser.ui smallfoot.grm.uo smallfoot.lex.uo  Parsetree.uo
	$(HOLMOSMLC) -c -I $(MLYACCLIB) $(MLYACCLIB_UIS) smallfoot.grm.ui smallfoot.lex.ui $<


