OPTIONS = NO_OVERLAY
EXTRA_CLEANS = Doc2Html.exe Doc2Tex.exe Doc2Txt.exe makebase.exe \
               Lexer.lex.sml Parser.grm.sml Parser.grm-sig.sml

MLYACCLIB = $(protect $(HOLDIR)/tools/mlyacc/mlyacclib/)
MLYACCLIB_UIS = $(patsubst %,MLY_%.ui,base-sig join lrtable parser2 stream)

all: makebase.exe Doc2Html.exe Doc2Tex.exe Doc2Txt.exe

makebase.exe : Database.uo Htmlsigs.uo Lexer.lex.uo Parser.grm.uo Parsspec.uo Printbase.uo Texsigs.uo makebase.uo
	HOLMOSMLC -o makebase.exe makebase.uo

Doc2Html.exe : Doc2Html.uo ParseDoc.uo Symbolic.uo
	HOLMOSMLC -o Doc2Html.exe Doc2Html.uo

Doc2Tex.exe : Doc2Tex.uo ParseDoc.uo Symbolic.uo
	MOSMLC -o Doc2Tex.exe Doc2Tex.uo

Doc2Txt.exe: Doc2Txt.uo ParseDoc.uo Symbolic.uo
	MOSMLC -o Doc2Txt.exe Doc2Txt.uo

Parser.grm.sml Parser.grm-sig.sml: Parser.grm
	$(protect $(HOLDIR)/tools/mlyacc/src/mlyacc.exe) $<
	$(MV) Parser.grm.sig Parser.grm-sig.sml

Parser.grm-sig.uo Parser.grm-sig.ui: Parser.grm-sig.sml Asynt.uo
	$(HOLMOSMLC) -toplevel -c -I $(MLYACCLIB) $(MLYACCLIB_UIS) $<

Parser.grm.uo: Parser.grm.sml Parser.grm-sig.uo Asynt.uo
	$(HOLMOSMLC) -toplevel -c -I $(MLYACCLIB) $(MLYACCLIB_UIS) Parser.grm-sig.ui $<

Lexer.lex.sml: Lexer.lex
	$(protect $(HOLDIR)/tools/mllex/mllex.exe) $<

Lexer.lex.uo: Lexer.lex.sml
	$(HOLMOSMLC) -toplevel -c Parser.grm-sig.ui $<

Parsspec.uo: Parser.grm.uo Lexer.lex.uo
