\chapter{Getting and Installing HOL-Omega}
\label{install}

This chapter describes how to get the \HOLW{} system and how to install
it.  It is generally assumed that some sort of Unix system is being
used, but the instructions that follow should apply {\it mutatis
  mutandis\/} to other platforms.  Unix is not a pre-requisite for
using the system. \HOLW{} may be run on PCs running Windows operating
systems from Windows~NT onwards (i.e., Windows~2000, XP and Vista are
also supported), as well as Macintoshes running Mac~OS~X.

\section{Getting HOL-Omega}

% The \HOLW{} system can be downloaded from
% % \url{http://hol.sourceforge.net}.
% \url{https://github.com/mn200/HOL} as part of the \HOL\ system. 
% % \HOLW\ is an extension of \HOL{-4}, and is backwards compatible with it.
\HOLW{} is part of the \HOL\ system.
% The \HOL\ system has several branches; branch {\tt HOL-Omega} is where
% development of the HOL-Omega theorem prover occurs.
The \HOL\ system has several branches; branch {\tt HOL-Omega} contains
the source of the HOL-Omega theorem prover.
The naming scheme for \holnw{}
releases is $\langle${\it name}$\rangle$-$\langle${\it
  number}$\rangle$; the release described here is \holnversion.

\HOL\ development uses the Git version control system.
Git is freely available from \texttt{http://git-scm.com/},
and is well described in the book {\it ProGit\/} by Scott Chacon.

A fresh copy of the current developer version of \HOLW\ may be checked out
into a fresh subdirectory called {\tt hol-omega} by the following Git command:
\begin{center}
\texttt{git clone -b HOL-Omega git://github.com/mn200/HOL.git hol-omega}
\end{center}

As a developer, to check out a fresh copy of \HOLW\ that one could
edit and write back to the github repository, one would set up a SSH key
with github and then do
\begin{center}
\texttt{git clone -b HOL-Omega git@github.com:mn200/HOL.git hol-omega}
\end{center}

\noindent
%To set up a SSH key with github, see
To set up a SSH key, see
%\begin{center}
\texttt{https://help.github.com/articles/generating-ssh-keys}.
%\end{center}

To become an \HOL\ developer and have write access to the github
repository, please contact one of the administrators listed at
\texttt{http://sourceforge.net/projects/hol/}.

\section{The {\tt hol-info} mailing list}

The \texttt{hol-info} mailing list serves as a forum for discussing
\HOLW{} and disseminating news about it.  If you wish to be on this
list (which is recommended for all users of \HOLW), visit
\url{http://lists.sourceforge.net/lists/listinfo/hol-info}.  This
web-page can also be used to unsubscribe from the mailing list.

\section{Installing HOL-Omega}

It is assumed that the \HOLW{} sources have been obtained and the
\texttt{tar} file unpacked into a directory \ml{hol-omega}.\footnote{You may
  choose another name if you want; it is not important.} The contents
of this directory are likely to change over time, but it should
contain the following:

\begin{center}
\begin{tabular}{|l|l|l|} \hline
\multicolumn{3}{|c|}{ } \\
\multicolumn{3}{|c|}{\bf Principal Files on the HOL-Omega Distribution Directory} \\
\multicolumn{3}{|c|}{ } \\
{\it File name} & {\it Description} & {\it File type}  \\ \hline
{\tt README} & Description of directory {\tt hol-omega} & Text\\
{\tt COPYRIGHT}& A copyright notice & Text\\
{\tt INSTALL} & Installation instructions & Text\\
{\tt tools} & Source code for building the system & Directory\\
{\tt bin} & Directory for HOL-Omega executables & Directory\\
{\tt sigobj} & Directory for \ML{} object files & Directory\\
{\tt src} & \ML{} sources of \HOLW & Directory\\
{\tt help} & Help files for \HOLW{} system & Directory\\
{\tt examples} & Example source files & Directory\\
\hline
\end{tabular}
\end{center}

The session in the box below shows a typical distribution directory.
The \HOLW{} distribution has been placed
in the directory {\small\tt /Users/palantir/hol-omega/}
on a Macintosh running OS X
% in the home directory of
for a user {\small\tt palantir}.

All sessions in this documentation will be displayed in boxes with a
number in the top right hand corner.  This number indicates whether
the session is a new one (when the number will be {\small\sl 1}) or
the continuation of a session started in an earlier box.
Consecutively numbered boxes are assumed to be part of a single
continuous session.  The Unix prompt for the sessions is
\texttt{\small \dol}, so lines beginning with this prompt were typed
by the user.  After entering the \HOLW{} system (see below), the user
is prompted with {\small\verb|-|} for an expression or command of the
\HOLW{} meta-language \ML; lines beginning with this are thus \ML\
expressions or declarations.  Lines not beginning with \texttt{\small
  \$} or {\small\verb|-|} are system output.  Occasionally, system
output will be replaced with a line containing {\small\verb|...|} when
it is of minimal interest. The meta-language \ML{} is introduced in
Chapter~\ref{ML}.

\setcounter{sessioncount}{0}
\begin{session}
% COPYRIGHT  bin/  examples/  INSTALL  src/
% README     doc/  help/      sigobj/  tools/
\begin{verbatim}
$ pwd
/Users/palantir/hol-omega
$ ls -F
COPYRIGHT   bin/          examples/   sigobj/       tools-poly/
INSTALL	    cleanall*     help/       src/
Manual/	    developers/   icon.gif*   std.prelude 
README      doc/          merging     tools/
\end{verbatim}
\end{session}

Now you will need to rebuild \HOLW{} from the sources.\footnote{It is
  possible that pre-built systems may soon be available from the
  web-page mentioned above.}

Before beginning you must have a current version of Moscow~ML or
Poly/ML\footnote{Poly/ML cannot be used with HOL-Omega on Windows.}.  In the
case of Moscow~ML, you must have version 2.01.  Moscow~ML is available
on the web from \url{http://www.dina.kvl.dk/~sestoft/mosml.html}.
Poly/ML is available from \url{http://polyml.org}. When you have your
ML system installed, and are in the root directory of the
distribution, the next step is to run \texttt{smart-configure}.  With
Moscow~ML, this looks like:

\begin{session}
\begin{alltt}
\dol mosml < tools/smart-configure.sml
Moscow ML version 2.01 (January 2004)
Enter `quit();' to quit.
- [opening file "tools/smart-configure-mosml.sml"]

HOL-Omega smart configuration.

Determining configuration parameters: OS mosmldir holdir
OS:                 macosx
mosmldir:           /Users/palantir/mosml/bin
holdir:             /Users/palantir/hol-omega
dynlib_available:   true

Configuration will begin with above values.  If they are wrong
press Control-C.
\end{alltt}
\end{session}

If you are using Poly/ML, then write
\begin{verbatim}
   poly < tools/smart-configure.sml
\end{verbatim}
instead.

Assuming you don't interrupt the configuration process, this will
build the \texttt{Holmake} and \texttt{build} programs, and move them
into the \texttt{hol-omega/bin} directory.  If something goes wrong at this
stage, consult Section~\ref{sec:editting-configure} below.

The next step is to run the \texttt{build} program.  This should
result in a great deal of output as all of the system code is compiled
and the theories built.  Eventually, a \HOLW{} system\footnote{Four
  \HOLW{} executables are produced: \textsf{hol}, \textsf{hol.noquote},
  \textsf{hol.bare} and \textsf{hol.bare.noquote}.  The first of these
  will be used for most examples in the \TUTORIAL{}.} is produced in
the \texttt{bin/} directory.

\begin{session}
\begin{alltt}
\dol bin/build
  ...
  ...
Uploading files to /Users/palantir/hol-omega/sigobj

Hol built successfully.
\dol
\end{alltt}
\end{session}


\subsection{Overriding \texttt{smart-configure}}
\label{sec:editting-configure}

If \texttt{smart-configure} is unable to guess correct values for the
various parameters (\texttt{holdir}, \texttt{OS} \etc) then you can
create a file called to provide correct values.  With Moscow~ML, this
should be \texttt{config-override} in the root directory of the HOL-Omega
distribution.  With Poly/ML, this should be \texttt{poly-includes.ML}
in the \texttt{tools-poly} directory. In this file, specify the
correct value for the appropriate parameter by providing an ML binding
for it.  All variables except \texttt{dynlib\_available} must be given
a string as a possible value, while \texttt{dynlib\_available} must be
either \texttt{true} or \texttt{false}.  So, one might write

\begin{session}
\begin{verbatim}
val OS = "unix";
val holdir = "/local/scratch/myholdir";
val dynlib_available = false;
\end{verbatim}
\end{session}

The \texttt{config-override} file need only provide values for those
variables that need overriding.

With this file in place, the \texttt{smart-configure} program will use
the values specified there rather than those it attempts to calculate
itself.  The value given for the \texttt{OS} variable must be one of
\texttt{"unix"}, \texttt{"linux"}, \texttt{"solaris"},
\texttt{"macosx"} or \texttt{"winNT"}.\footnote{The string
  \texttt{"winNT"} is used for Microsoft Windows operating systems
  that are at least as recent as Windows~NT.  This includes
  Windows~2000, XP and Vista.}

In extreme circumstances it is possible to edit the file
\texttt{tools/configure.sml} yourself to set configuration variables
directly.  (If you are using Poly/ML, you must edit
\texttt{tools-poly/configure.sml} instead.) At the top of this file
various incomplete SML declarations are present, but commented out.
You will need to uncomment this section (remove the \texttt{(*} and
\texttt{*)} markers), and provide sensible values.  All strings must
be enclosed in double quotes.

The \texttt{holdir} value must be the name of the top-level directory
listed in the first session above.  The \texttt{OS} value should be
one of the strings specified in the accompanying comment.

When working with Moscow~ML, the \texttt{mosmldir} value must be the
name of the directory containing the Moscow~ML binaries
(\texttt{mosmlc}, \texttt{mosml}, \texttt{mosmllex} etc).  When
working with Poly/ML, the \texttt{poly} string must be the path to the
\texttt{poly} executable that begins an interactive \ML{} session.
The \texttt{polymllibdir} must be a path to a directory that contains
the file \texttt{libpolymain.a}.

Subsequent values (\texttt{CC} and \texttt{GNUMAKE}) are needed for
``optional'' components of the system.  The first gives a string
suitable for invoking the system's C compiler, and the second
specifies a \textsf{make} program.

After editing, \texttt{tools/configure.sml} the lines above will look
something like:

\begin{session}
\begin{alltt}
\dol more configure.sml
  ...
val mosmldir:string = "/home/palantir/mosml";
val holdir :string  = "/home/palantir/hol-omega";
val OS :string      = "linux";
                           (* Operating system; choices are:
                                "linux", "solaris", "unix", "macosx",
                                "winNT"   *)

val CC:string       = "gcc";      (* C compiler                       *)
val GNUMAKE:string  = "make";     (* for bdd library and SMV          *)
val DEPDIR:string   = ".HOLMK";   (* where Holmake dependencies kept  *)
  ...
\dol
\end{alltt}
\end{session}

\noindent Now, at either this level (in the \texttt{tools} or
\texttt{tools-poly} directory) or at the level above, the script
\texttt{configure.sml} must be piped into the \ML{} interpreter (\ie,
\texttt{mosml} or \texttt{poly}).  For example,

\begin{session}
\begin{alltt}
\dol mosml < tools/configure.sml
Moscow ML version 2.01 (January 2004)
Enter `quit();' to quit.
- > val mosmldir = "/home/palantir/mosml" : string
  val holdir = "/home/palantir/hol-omega" : string
  val OS = "linux" : string
- > val CC = "gcc" : string
  ...
Beginning configuration.
Removing old quotation filter from bin/
Making tools/mllex/mllex.exe
Making bin/Holmake.
  ...
Making bin/build.
Making hol-mode.el (for Emacs/XEmacs)
Generating bin/hol.
Generating bin/hol.noquote.
  ...
Number of states = 170
Number of distinct rows = 90
Approx. memory size of trans. table = 23040 bytes
Analysing filter.sml
Compiling filter.sml
Compiling quote-filter.sml
  ...
Analysing selftest.sml
Quote-filter built
Setting up the muddy library Makefile.

Finished configuration!
\dol
\end{alltt}
\end{session}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "tutorial"
%%% End:
